<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>messengerWeb</title>
    <link rel="stylesheet" href="style.css">
    <link rel = 'icon' href="logo.png">
</head>
<body>
<header>
<img src="logo.png" alt="messenger logo">
<div id="leftHeader">
  
<div id="compose"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chat-dots" viewBox="0 0 16 16">
    <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
    <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"/>
  </svg></div>
  <div id="menuRemo"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16">
    <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
  </svg></div>
<div id="menu"><svg id="menuShow" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-menu-app" viewBox="0 0 16 16">
    <path d="M0 1.5A1.5 1.5 0 0 1 1.5 0h2A1.5 1.5 0 0 1 5 1.5v2A1.5 1.5 0 0 1 3.5 5h-2A1.5 1.5 0 0 1 0 3.5zM1.5 1a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 0-.5-.5zM0 8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm1 3v2a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2zm14-1V8a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2zM2 8.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0 4a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5"/>
  </svg></div>
  </div>
</header>

<script>
    var userData = '';
    var logStatus ='';
    (async()=>{
        logStatus = localStorage.getItem('logStatus');
        var author = localStorage.getItem('author');
        var Data =localStorage.getItem('userData');
        
        if(logStatus != 'done' || !logStatus || logStatus == ''){
            var newD = document.createElement('div');
            newD.id = 'account';
            newD.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-fill-exclamation" viewBox="0 0 16 16">
            <path d="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0m-9 8c0 1 1 1 1 1h5.256A4.5 4.5 0 0 1 8 12.5a4.5 4.5 0 0 1 1.544-3.393Q8.844 9.002 8 9c-5 0-6 3-6 4"/>
            <path d="M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0m-3.5-2a.5.5 0 0 0-.5.5v1.5a.5.5 0 0 0 1 0V11a.5.5 0 0 0-.5-.5m0 4a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"/>
          </svg>`;
            document.getElementById('leftHeader').appendChild(newD);
        }
        else{

        var preResult = await fetch(`http://localhost:3000/userData?id=${Data}`);
        userData = await preResult.json();
            var image = userData[0].profile;
            var newD = document.createElement('div');
            newD.id = 'profile';
            newD.addEventListener('click',profiler);
            newD.innerHTML = `<img src='${image}' alt="" srcset="">`;
            document.getElementById('leftHeader').appendChild(newD);
            //document.getElementById('leftHeader').innerHTML += `<div id="profile"><img src=${image} alt="" srcset=""></div>`;
        }
        document.getElementById('menuShow').addEventListener('click',showMenu);
        document.getElementById('menuRemo').addEventListener('click',hideMenu);
        document.getElementById('compose').addEventListener('click',composer);
        document.getElementById('account').addEventListener('click',signIn);
    })();
    function profiler(){
        window.location.href = 'http://localhost:3000/profiler';
    }
    function showMenu(){
        document.getElementById('menuLi').style.display='block';
        document.getElementById('menu').style.display='none';
        document.getElementById('menuRemo').style.display='block';

    }
    function hideMenu(){
        document.getElementById('menuLi').style.display='none';
        document.getElementById('menu').style.display='block';
        document.getElementById('menuRemo').style.display='none';
    }
    function composer(){
        if(userData == ''){
            alert("Sign In to use messenger");
        window.location.href='http://localhost:3000/signIn';
        }
        else{
        window.location.href='http://localhost:3000/chats';
        }
    }
    function signIn(){
        window.location.href='http://localhost:3000/signIn';
    }
</script>
</body>
</html>